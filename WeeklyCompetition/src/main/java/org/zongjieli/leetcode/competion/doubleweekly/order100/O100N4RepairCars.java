package org.zongjieli.leetcode.competion.doubleweekly.order100;

/**
 * 给定一个整数数组 ranks,表示一些机械工的能力值
 * ranksI 是第 i 位机械工的能力值,能力值为 r 的机械工可以在 r * n^2 分钟内修好 n 辆车
 * 同时给定一个整数 cars,表示总共需要修理的汽车数目
 * 请返回修理所有汽车最少需要多少时间
 * 注意: 所有机械工可以同时修理汽车
 *
 * 1 <= ranks.length <= 10^5
 * 1 <= ranks[i] <= 100
 * 1 <= cars <= 10^6
 *
 * @author Li.zongjie
 * @version 1.0
 * @date 2023/3/18
 */
public class O100N4RepairCars {

    public long repairCars(int[] ranks, int cars) {
        if (can(ranks, cars, 1L)) {
            return 1L;
        }
        long left = 1L, right = 100000000000000L;
        while (left < right) {
            long middle = (left + right) / 2;
            if (can(ranks, cars, middle)) {
                right = middle;
            } else {
                left = middle + 1;
            }
        }
        return right;
    }

    public boolean can(int[] ranks, int cars, long time) {
        long sum = 0;
        for (int rank : ranks) {
            sum += (int) Math.sqrt((double) time / rank);
        }
        return sum >= cars;
    }

    public static void main(String[] args) {
        O100N4RepairCars test= new O100N4RepairCars();
        // 677047
        System.out.println(test.repairCars(new int[]{15,20,19,22,30,11,3,22,21,11,6,6,3,22,4,4,25,7,27,14,31,8,5,4,24,9,5,4,31,6,14,12,7,3,30,3,23,23,30,26,13,21,29,8,1,17,14,6,4,2,29,5,23,31,3,28,28,23,6,15,26,14,29,26,26,11,15,15,25,26,27,10,5,14,16,22,15,18,26,1,25,28,14,6,28,19,31,7,27,5,18,16,31,7,30,13,21,26,30,3,24,27,4,10,16,29,3,3,11,2,4,14,7,23,16,23,19,18,11,6,1,8,23,13,1,23,12,14,8,11,3,13,15,3,4,14,8,10,26,6,26,19,16,1,4,11,7,21,21,5,8,29,3,7,1,12,1,29,4,12,21,23,23,29,8,5,6,28,3,21,17,30,24,15,5,14,28,20,25,4,11,23,13,12,11,10,28,31,12,6,5,7,11,10,13,30,22,27,31,12,22,15,10,19,25,15,8,24,2,15,7,3,13,19,30,13,19,28,7,7,28,25,20,14,9,5,26,31,4,29,12,24,30,28,6,31,5,15,25,30,15,3,25,30,11,8,3,25,22,4,4,3,7,16,4,14,26,6,13,27,28,7,28,19,17,14,17,17,3,6,18,3,27,1,16,17,23,27,20,13,20,17,30,31,27,13,26,4,5,27,15,24,1,5,11,12,24,17,6,12,20,3,3,6,7,26,29,19,10,31,15,15,15,17,16,30,24,21,14,1,29,10,7,24,15,24,17,24,29,3,4,3,4,21,15,27,14,12,23,15,19,25,5,11,16,8,31,28,29,25,8,9,8,25,20,10,5,31,13,15,3,3,30,27,18,30,15,29,7,5,3,30,12,24,26,8,5,9,3,16,25,29,9,8,31,10,31,28,22,20,17,23,10,7,17,12,10,29,21,14,27,20,1,11,14,4,14,9,6,12,22,17,18,28,22,5,25,29,28,31,28,31,13,11,7,20,4,11,4,16,27,19,9,26,13,26,28,1,11,15,5,27,29,17,12,30,8,29,16,6,1,11,15,30,12,23,21,18,10,13,7,17,13,2,9,3,28,31,2,10,28,31,18,4,6,9,13,18,31,5,23,27,20,3,31,12,5,21,17,22,7,24,31,30,5,14,22,1,26,13,19,20,25,17,4,22,2,12,8,26,10,4,6,23,6,22,21,20,23,4,11,24,26,15,6,11,26,2,30,8,29,18,11,20,24,27,24,25,22,26,6,19,31,28,5,17,21,18,29,29,19,2,7,10,21,12,6,19,1,28,3,10,20,3,23,7,6,5,26,3,23,20,25,6,4,14,29,27,2,14,19,13,15,16,14,11,3,20,21,4,7,27,6,8,25,16,24,31,29,18,9,13,29,3,19,11,19,23,7,26,19,27,6,1,22,18,29,8,7,17,17,7,4,12,14,9,2,8,20,17,31,24,27,26,4,23,25,26,23,4,5,12,9,2,3,4,14,3,29,17,2,16,2,25,11,9,19,8,20,26,18,13,25,26,21,15,1,14,27,31,7,3,5,20,27,5,22,11,5,17,15,16,13,29,6,7,3,12,7,23,23,9,31,26,12,20,19,4,15,8,23,25,11,10,20,22,21,17,9,31,4,4,19,1,12,13,21,4,29,24,4,8,20,5,16,5,26,14,26,1,18,23,21,30,20,10,29,7,12,26,3,2,16,27,21,31,27,8,14,19,18,24,23,31,9,19,12,18,10,16,7,15,17,18,17,14,21,16,18,6,26,7,5,10,25,24,1,27,15,29,14,13,31,19,8,14,15,29,21,29,1,3,30,24,20,10,9,30,30,15,22,1,28,6,12,1,5,11,26,16,9,12,12,31,9,20,23,15,28,1,7,4,24,14,23,17,28,9,23,11,3,10,6,2,2,12,20,24,2,29,29,19,5,20,15,8,13,16,25,10,9,18,7,30,25,19,17,28,30,26,29,22,1,5,18,24,2,1,24,24,17,26,2,20,21,11,30,8,20,26,25,27,16,22,12,10,24,14,9,22,4,18,27,13,7,26,25,10,31,20,14,4,11,4,5,16,6,12,18,17,28,19,9,20,20,14,25,11,11,27,16,25,12,31,9,21,13,27,31,7,3,4,16,20,25,19,21,22,23,24,30,8,8,13,4,13,28,26,8,8,12,22,15,22,21,5,9,21,11,19,20,31,11,9,22,24,7,13,27,10,31,2,6,3,23,20,20,16,24,7,12,16,18,30,1,22,16,19,17,27,19,16}, 254488));
    }
}
